"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[942],{71:(e,t,r)=>{r.d(t,{h:()=>n});let a={inferno:"inferno",holliday:"astro",paradox:"chrono",orion:"archer",ghost:"spectre",vindicta:"hornet",seven:"gigawatt",atlas:"bull",forge:"engineer",dynamo:"sumo",calico:"nano",krill:"digger",fathom:"slork",pocket:"synth","the boss":"yakuza",viper:"kali","generic person":"genericperson","lady geist":"spectre","mo and krill":"digger",infernus:"inferno",mcginnis:"engineer","grey talon":"archer",ivy:"tengu",abrams:"bull"};function n(e){let t=e.toLowerCase();return a[t]?a[t]:t.replace(/\s+/g,"")}},942:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var a=r(5155),n=r(2115);let s=(0,n.forwardRef)((e,t)=>{let{audioSrc:r,isPlaying:s=!1,onPlayStateChange:o,small:l=!1}=e,[c,i]=(0,n.useState)(s),[d,u]=(0,n.useState)(0),[h,m]=(0,n.useState)(0),g=(0,n.useRef)(null);(0,n.useImperativeHandle)(t,()=>({reset:()=>{g.current&&(g.current.currentTime=0,m(0))}})),(0,n.useEffect)(()=>{i(s)},[s]),(0,n.useEffect)(()=>{g.current&&(c?g.current.play().catch(e=>{console.error("Error playing audio:",e),i(!1),o&&o(!1)}):g.current.pause())},[c,o]);let x=e=>{let t=Math.floor(e/60),r=Math.floor(e%60);return"".concat(t,":").concat(r<10?"0":"").concat(r)};return(0,a.jsxs)("div",{className:"".concat(l?"w-8":"w-full"," flex items-center"),children:[(0,a.jsx)("audio",{ref:g,src:r,onLoadedMetadata:()=>{g.current&&u(g.current.duration)},onTimeUpdate:()=>{g.current&&m(g.current.currentTime)},onEnded:()=>{i(!1),m(0),o&&o(!1)}}),(0,a.jsx)("button",{onClick:()=>{let e=!c;i(e),o&&o(e)},className:"flex-shrink-0 ".concat(l?"w-8 h-8":"w-10 h-10"," rounded-full bg-blue-600 flex items-center justify-center hover:bg-blue-700 focus:outline-none"),"aria-label":c?"Pause":"Play",children:c?(0,a.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):(0,a.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),!l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex-grow mx-4",children:(0,a.jsx)("input",{type:"range",min:"0",max:d||0,value:h,onChange:e=>{let t=parseFloat(e.target.value);m(t),g.current&&(g.current.currentTime=t)},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"})}),(0,a.jsxs)("div",{className:"flex-shrink-0 text-sm text-gray-400 w-16 text-right",children:[x(h)," / ",x(d)]})]})]})});s.displayName="AudioPlayer";var o=r(5565),l=r(4957),c=r(71);let i=e=>{let{conversation:t}=e,[r,i]=(0,n.useState)({}),[d,u]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1),[g,x]=(0,n.useState)([]),[v,p]=(0,n.useState)(!1),[f,w]=(0,n.useState)(0),b=(0,n.useRef)(null),j=(0,n.useRef)([]),y=(0,l.v)(t.character1),N=(0,l.v)(t.character2);(0,n.useEffect)(()=>{let e={};t.lines.forEach(t=>{e[t.part]||(e[t.part]=[]),e[t.part].push(t)});let r={};Object.entries(e).forEach(e=>{let[t,a]=e;r[parseInt(t)]=a[0].variation}),i(r)},[t]),(0,n.useEffect)(()=>{x(t.lines.filter(e=>e.variation===r[e.part]).sort((e,t)=>e.part-t.part))},[t,r]),(0,n.useEffect)(()=>{h&&null===d&&g.length>0&&u(0)},[h,d,g]);let k=(e,t)=>{t?u(e):d===e&&(h&&e<g.length-1?u(e+1):(h&&m(!1),u(null)))},C=(e,t)=>{i(r=>({...r,[e]:t}))},S=async(e,t)=>{let r=await fetch(e),a=await r.arrayBuffer();return await t.decodeAudioData(a)},_=async()=>{if(0!==g.length&&!v){p(!0),w(0);try{b.current||(b.current=new(window.AudioContext||window.webkitAudioContext));let e=b.current,r=[];for(let t=0;t<g.length;t++){let a=g[t],n="/audioFiles/".concat(a.filename);try{let t=await S(n,e);r.push(t)}catch(e){console.error("Error loading audio for line ".concat(t,":"),e)}w(Math.round((t+1)/g.length*100))}let a=r.reduce((e,t)=>e+t.duration,0),n=e.createBuffer(r[0].numberOfChannels,e.sampleRate*a,e.sampleRate),s=0;for(let t of r){for(let r=0;r<t.numberOfChannels;r++){let a=t.getChannelData(r);n.copyToChannel(a,r,Math.floor(s*e.sampleRate))}s+=t.duration}let o=R(n,e.sampleRate),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download="".concat(t.character1,"_").concat(t.character2,"_conversation.wav"),c.click(),URL.revokeObjectURL(l),p(!1),w(0)}catch(e){console.error("Error generating download:",e),p(!1),w(0),alert("Error generating download. Please try again.")}}},R=(e,t)=>{let r=e.numberOfChannels,a=e.length*r*2,n=new ArrayBuffer(44+a),s=new DataView(n);E(s,0,"RIFF"),s.setUint32(4,36+a,!0),E(s,8,"WAVE"),E(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,r,!0),s.setUint32(24,t,!0),s.setUint32(28,t*r*2,!0),s.setUint16(32,2*r,!0),s.setUint16(34,16,!0),E(s,36,"data"),s.setUint32(40,a,!0);let o=44;for(let t=0;t<e.length;t++)for(let a=0;a<r;a++){let r=Math.max(-1,Math.min(1,e.getChannelData(a)[t])),n=r<0?32768*r:32767*r;s.setInt16(o,n,!0),o+=2}return new Blob([n],{type:"audio/wav"})},E=(e,t,r)=>{for(let a=0;a<r.length;a++)e.setUint8(t+a,r.charCodeAt(a))},I={};t.lines.forEach(e=>{I[e.part]||(I[e.part]=[]),I[e.part].push(e)});let M=Object.values(I).some(e=>e.length>1),L=e=>{let t=(0,c.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")};return(0,n.useEffect)(()=>{j.current=Array(g.length).fill(null)},[g.length]),(0,a.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-2",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-white",children:["Conversation: ",y," & ",N]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{h?(m(!1),u(null)):(m(!0),u(0),j.current.forEach(e=>{e&&e.reset()}))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none flex items-center",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Stop Playing"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),"Play All"]})}),(0,a.jsx)("button",{onClick:_,disabled:v||0===g.length,className:"px-4 py-2 rounded-lg focus:outline-none flex items-center ".concat(v||0===g.length?"bg-gray-600 text-gray-300 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f,"%"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Download"]})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[!t.is_complete&&(0,a.jsx)("span",{className:"px-3 py-1 bg-yellow-800 text-yellow-100 rounded-full text-sm",children:"Incomplete Conversation"}),t.missing_parts.length>0&&(0,a.jsxs)("span",{className:"px-3 py-1 bg-red-800 text-red-100 rounded-full text-sm",children:["Missing Parts: ",t.missing_parts.join(", ")]})]}),M&&(0,a.jsxs)("div",{className:"mb-6 bg-gray-800 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"Select Variations"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(I).map(e=>{let[t,s]=e;return(0,a.jsx)(n.Fragment,{children:s.length>1&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"text-gray-300 w-24",children:["Part ",t,":"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(e=>(0,a.jsxs)("button",{onClick:()=>C(e.part,e.variation),className:"px-3 py-1 rounded-full text-sm ".concat(r[e.part]===e.variation?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:["Variation ",e.variation]},"var-btn-".concat(e.part,"-").concat(e.variation)))})]},"part-".concat(t))},"part-container-".concat(t))})})]}),(0,a.jsx)("div",{className:"space-y-4 max-w-2xl mx-auto",children:g.map((e,r)=>{let n=(0,l.v)(e.speaker);return(0,a.jsx)("div",{className:"flex ".concat(e.speaker===t.character1?"justify-start":"justify-end"),children:(0,a.jsxs)("div",{className:"flex max-w-[80%] ".concat(e.speaker===t.character1?"flex-row":"flex-row-reverse"),children:[(0,a.jsx)("div",{className:"flex-shrink-0 mx-2",children:(0,a.jsx)("div",{className:"relative w-10 h-10",children:(0,a.jsx)(o.default,{src:L(e.speaker),alt:"".concat(n," portrait"),fill:!0,sizes:"40px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})})}),(0,a.jsxs)("div",{className:"rounded-lg p-3 ".concat(e.speaker===t.character1?"bg-blue-800 rounded-tl-none":"bg-green-800 rounded-tr-none"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("span",{className:"font-semibold text-white",children:n}),(0,a.jsxs)("span",{className:"text-xs text-gray-300 ml-2",children:["Part ",e.part]})]}),(0,a.jsx)("p",{className:"text-white mb-2",children:e.transcription}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(s,{ref:e=>{j.current[r]=e},audioSrc:"/audioFiles/".concat(e.filename),isPlaying:d===r,onPlayStateChange:e=>k(r,e)})})]})]})},"line-".concat(e.part,"-").concat(e.variation,"-").concat(r))})}),t.missing_parts.map(e=>(0,a.jsx)("div",{className:"my-4 p-3 bg-red-900/30 border border-red-800 rounded-lg text-center",children:(0,a.jsxs)("p",{className:"text-red-300",children:[(0,a.jsx)("svg",{className:"w-5 h-5 inline-block mr-1",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Missing dialogue part ",e]})},"missing-".concat(e)))]})};var d=r(8173),u=r.n(d),h=r(6046),m=r(9895),g=r(3116),x=r(3341);let v="previousPath";function p(e){let{conversationId:t}=e,r=(0,h.useRouter)(),s=(0,h.usePathname)(),[o,c]=(0,n.useState)("/conversations"),{data:d}=(0,m.E)(),[p,f]=(0,n.useState)(null),[w,b]=(0,n.useState)(!0),[j,y]=(0,n.useState)(null),[N,k]=(0,n.useState)([]),[C,S]=(0,n.useState)([]),[_,R]=(0,n.useState)([]),[E,I]=(0,n.useState)(0),[M,L]=(0,n.useState)(0),[P,B]=(0,n.useState)(0),[U,z]=(0,n.useState)([]),[A,F]=(0,n.useState)(null),[T,V]=(0,n.useState)(null),[O,W]=(0,n.useState)(null),[D,G]=(0,n.useState)(null);if((0,n.useEffect)(()=>{(async function(){try{b(!0);let e=await (0,x.Mq)(),r=decodeURIComponent(t),a=(0,x.mo)(e,r);if(!a){y("Conversation not found"),b(!1);return}f(a),(0,g.n0)(a.conversation_id),b(!1)}catch(e){console.error("Error loading conversation data:",e),y("Failed to load conversation data"),b(!1)}})()},[t]),w)return(0,a.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(j||!p)return(0,a.jsxs)("div",{className:"bg-red-900/30 border border-red-800 rounded-lg p-4 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-red-300 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-red-200",children:j||"Conversation not found"}),(0,a.jsx)(u(),{href:"/",className:"mt-4 inline-block text-blue-400 hover:underline",children:"Return to Home"})]});let H=(0,l.v)(p.character1),J=(0,l.v)(p.character2);(0,n.useEffect)(()=>{{let e=sessionStorage.getItem(v),t=sessionStorage.getItem("selectedPartners"),r=sessionStorage.getItem("searchTerm"),a=sessionStorage.getItem("characterFilter"),n=sessionStorage.getItem("completenessFilter");if(e&&e!==s){if(c(e),e.includes("/characters/")){let r=e.split("/characters/")[1];if(r&&(F(decodeURIComponent(r.split("/")[0].split("?")[0])),t))try{let e=JSON.parse(t);Array.isArray(e)&&z(e)}catch(e){console.error("Error parsing selected partners:",e)}}e.includes("/conversations")&&!e.includes("/conversations/")&&(r&&V(r),a&&W(a),n&&G(n))}let o=()=>{sessionStorage.setItem(v,s)};return window.addEventListener("beforeunload",o),()=>{window.removeEventListener("beforeunload",o)}}},[s]),(0,n.useEffect)(()=>{if(d&&p){let e=d.conversations.filter(e=>e.character1===p.character1&&e.character2===p.character2||e.character1===p.character2&&e.character2===p.character1).sort((e,t)=>e.conversation_id.localeCompare(t.conversation_id));k(e);let t=e.findIndex(e=>e.conversation_id===p.conversation_id);if(-1!==t&&I(t),A&&U.length>0){let e=d.conversations.filter(e=>{if(e.character1!==A&&e.character2!==A)return!1;let t=e.character1===A?e.character2:e.character1;return U.includes(t)}).sort((e,t)=>e.conversation_id.localeCompare(t.conversation_id));S(e);let t=e.findIndex(e=>e.conversation_id===p.conversation_id);-1!==t&&L(t)}else if(A&&!U.length){let e=d.conversations.filter(e=>e.character1===A||e.character2===A).sort((e,t)=>e.conversation_id.localeCompare(t.conversation_id));S(e);let t=e.findIndex(e=>e.conversation_id===p.conversation_id);-1!==t&&L(t)}if(T||O||D){let e=[...d.conversations];if(T&&""!==T.trim()){let t=T.toLowerCase();e=e.filter(e=>e.lines.some(e=>e.transcription.toLowerCase().includes(t))||e.summary.toLowerCase().includes(t)||e.character1.toLowerCase().includes(t)||e.character2.toLowerCase().includes(t))}if(O&&"all"!==O&&(e=e.filter(e=>e.character1===O||e.character2===O)),D&&"all"!==D){let t="complete"===D;e=e.filter(e=>e.is_complete===t)}R(e);let t=e.findIndex(e=>e.conversation_id===p.conversation_id);-1!==t&&B(t)}}},[d,p,A,U,T,O,D]),(0,n.useEffect)(()=>{p&&(0,g.n0)(p.conversation_id)},[p]);let K=N.length>1,q=A&&C.length>1,Y=_.length>1&&(T||"all"!==O||"all"!==D),Q=A?(0,l.v)(A):"";return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,a.jsxs)("button",{onClick:()=>{r.push(o)},className:"inline-flex items-center text-blue-400 hover:underline bg-transparent border-none cursor-pointer",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),(()=>{if(o.includes("/characters/")){let e=o.split("/characters/")[1];if(e){let t=e.split("/")[0].split("?")[0];if(t)return"Back to ".concat((0,l.v)(decodeURIComponent(t)),"'s Profile")}}return"/conversations"===o||o.startsWith("/conversations?")?T?"Back to Search Results":"Back to All Conversations":"/"===o||""===o?"Back to Home":"Back"})()]}),Y&&(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-gray-400",children:["Search Result ",P+1," of ",_.length,T&&(0,a.jsxs)("span",{className:"ml-1",children:['for "',T,'"']})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(P>0&&_.length>1){let e=_[P-1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:0===P,className:"p-2 rounded-full ".concat(0===P?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Previous search result",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("button",{onClick:()=>{if(P<_.length-1){let e=_[P+1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:P===_.length-1,className:"p-2 rounded-full ".concat(P===_.length-1?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Next search result",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]}),!Y&&q&&(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-gray-400",children:[0===U.length?"".concat(Q,"'s Conversation"):1===U.length?"".concat(Q,"'s Conversation with ").concat((0,l.v)(U[0])):"".concat(Q,"'s Filtered Conversations")," ",M+1," of ",C.length]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(M>0&&C.length>1){let e=C[M-1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:0===M,className:"p-2 rounded-full ".concat(0===M?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Previous conversation",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("button",{onClick:()=>{if(M<C.length-1){let e=C[M+1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:M===C.length-1,className:"p-2 rounded-full ".concat(M===C.length-1?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Next conversation",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]}),!Y&&!q&&K&&(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-gray-400",children:["Conversation ",E+1," of ",N.length]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(E>0&&N.length>1){let e=N[E-1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:0===E,className:"p-2 rounded-full ".concat(0===E?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Previous conversation",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),(0,a.jsx)("button",{onClick:()=>{if(E<N.length-1){let e=N[E+1];r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))}},disabled:E===N.length-1,className:"p-2 rounded-full ".concat(E===N.length-1?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),"aria-label":"Next conversation",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})]})]}),(0,a.jsx)(i,{conversation:p}),(0,a.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,a.jsxs)(u(),{href:"/characters/".concat(p.character1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:["View ",H,"'s Profile"]}),(0,a.jsxs)(u(),{href:"/characters/".concat(p.character2),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white",children:["View ",J,"'s Profile"]})]}),K&&(0,a.jsxs)("div",{className:"mt-6 bg-gray-800 p-4 rounded-lg",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-white mb-3",children:["More conversations between ",H," and ",J]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg cursor-pointer ".concat(e.conversation_id===p.conversation_id?"bg-blue-900 border border-blue-700":"bg-gray-700 hover:bg-gray-600"),onClick:()=>{e.conversation_id!==p.conversation_id&&r.push("/conversations/".concat(encodeURIComponent(e.conversation_id)))},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("span",{className:"font-medium text-white",children:["Conversation ",t+1]}),!e.is_complete&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-yellow-800 text-yellow-100 rounded-full text-xs",children:"Incomplete"})]}),(0,a.jsx)("p",{className:"text-gray-300 text-sm mt-1 line-clamp-2",children:e.summary||(e.lines.length>0?e.lines[0].transcription:"No preview available")})]},e.conversation_id))})]})]})}},3116:(e,t,r)=>{r.d(t,{B2:()=>c,n0:()=>n,tG:()=>l,yV:()=>s});let a="viewedConversations";function n(e){try{let t=o();t.includes(e)||(t.push(e),localStorage.setItem(a,JSON.stringify(t)))}catch(e){console.error("Error marking conversation as viewed:",e)}}function s(e){try{return o().includes(e)}catch(e){return console.error("Error checking if conversation is viewed:",e),!1}}function o(){try{let e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch(e){return console.error("Error getting viewed conversations:",e),[]}}function l(){try{localStorage.removeItem(a)}catch(e){console.error("Error resetting viewed conversations:",e)}}function c(e,t){try{let r=o(),n=t.filter(t=>t.character1===e||t.character2===e).map(e=>e.conversation_id),s=r.filter(e=>!n.includes(e));localStorage.setItem(a,JSON.stringify(s))}catch(e){console.error("Error resetting character viewed conversations:",e)}}},3341:(e,t,r)=>{async function a(){try{{let e=await fetch("/Sample.json");if(!e.ok)throw Error("Failed to load data: ".concat(e.status," ").concat(e.statusText));return await e.json()}}catch(e){return console.error("Error loading conversation data:",e),{conversations:[],export_date:new Date().toISOString(),total_conversations:0}}}function n(e){if(!e.conversations||0===e.conversations.length)return[];let t=new Map;return e.conversations.forEach(e=>{var r,a;let n=e.character1,s=e.character2;t.has(n)||t.set(n,new Set),t.has(s)||t.set(s,new Set),null===(r=t.get(n))||void 0===r||r.add(s),null===(a=t.get(s))||void 0===a||a.add(n)}),Array.from(t.entries()).map(e=>{let[t,r]=e;return{name:t,iconPath:"/minimapIcons/".concat(t,"_mm_psd.png"),conversationPartners:Array.from(r)}})}function s(e,t){return e.conversations.filter(e=>e.character1===t||e.character2===t)}function o(e,t){let r=t.toLowerCase();return e.conversations.filter(e=>e.lines.some(e=>e.transcription.toLowerCase().includes(r))||e.summary.toLowerCase().includes(r))}function l(e,t){return e.conversations.find(e=>e.conversation_id===t)}r.d(t,{DI:()=>o,Mq:()=>a,TM:()=>s,mo:()=>l,w:()=>n}),new Date().toISOString()},4957:(e,t,r)=>{r.d(t,{v:()=>n});let a={inferno:"Infernus",gigawatt:"Seven",hornet:"Vindicta",ghost:"Lady Geist",tempest:"Tempest",atlas:"Abrams",wraith:"Wraith",forge:"McGinnis",chrono:"Paradox",sumo:"Dynamo",kelvin:"Kelvin",haze:"Haze",astro:"Holliday",bebop:"Bebop",nano:"Calico",orion:"Grey Talon",krill:"Mo and Krill",shiv:"Shiv",tengu:"Ivy",kali:"Kali",warden:"Warden",yamato:"Yamato",butcher:"Butcher",lash:"Lash",akimbo:"Akimbo",viscous:"Viscous",ballista:"Ballista",gunslinger:"Gunslinger",yakuza:"The Boss",spade:"Spade",genericperson:"Generic Person",tokamak:"Tokamak",wrecker:"Wrecker",rutger:"Rutger",synth:"Pocket",thumper:"Thumper",mirage:"Mirage",slork:"Fathom",cadence:"Cadence",targetdummy:"Target Dummy",bomber:"Bomber",viper:"Vyper","generic person":"Generic Person",generic:"Generic Person",mo:"Mo and Krill","the boss":"The Boss","grey talon":"Grey Talon","lady geist":"Lady Geist"};function n(e){return a[e.toLowerCase()]?a[e.toLowerCase()]:e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}},6046:(e,t,r)=>{var a=r(6658);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},9895:(e,t,r)=>{r.d(t,{DataProvider:()=>i,E:()=>c});var a=r(5155),n=r(2115),s=r(3341);let o={data:null,characters:[],loading:!0,error:null,refresh:async()=>{}},l=(0,n.createContext)(o),c=()=>(0,n.useContext)(l),i=e=>{let{children:t}=e,[r,c]=(0,n.useState)(null),[i,d]=(0,n.useState)([]),[u,h]=(0,n.useState)(!0),[m,g]=(0,n.useState)(null),[x,v]=(0,n.useState)(0),[p,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{f(!0)},[]);let w=async()=>{try{h(!0),g(null);let e=await (0,s.Mq)();if(0===e.conversations.length&&x<3){console.log("No conversations found, retrying... (".concat(x+1,"/3)")),v(e=>e+1),setTimeout(()=>w(),500);return}c(e),d((0,s.w)(e))}catch(e){console.error("Error loading data:",e),g("Failed to load conversation data. Please try again later.")}finally{h(!1)}},b=async()=>{v(0),await w()};return(0,n.useEffect)(()=>{p&&w()},[p]),(0,a.jsx)(l.Provider,{value:p?{data:r,characters:i,loading:u,error:m,refresh:b}:o,children:t})}}}]);